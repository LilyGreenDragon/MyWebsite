<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">
<head>
<meta  content="text/html; charset=utf-8" />
<title>Кабинетик</title>

<link th:href="@{/css/templatemo_style.css}" type="text/css" rel="stylesheet" />
<!-- Flatpickr стили -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

</head>

<body>
<div id="axis" class="one">
    <img class="object van move-right" src="/images/cartoon_car.png" alt="" /></div>
<span id="top"></span>
<div id="templatemo_wrapper">
	<div id="templatmeo_header">

		<div id="site_title">
				<h1><a th:href="@{/home}"></a></h1>
		</div>

        <div id="templatemo_menu">
            <ul>
                <!--<li><a th:href="@{/home}">Дом</a></li>-->
                <li class="last"><a th:href="@{/news}">Новости</a></li>
                <li class="last"><a th:href="@{/per}">Человек</a></li>
            </ul>
        </div> <!-- end of templatemo_menu -->
	</div> <!-- end of header -->


    <div id="templatemo_main">

        <div id="contactus" class="content_top"></div>
        <div class="content_box">
        	<div class="content_title content_contactus"></div>

            	<h2>Кабинетик</h2>
            <div class="cleaner"></div>

            <p><h6>Приветствуем Вас в личном кабинете. Здесь вы можете разместить информацию о себе)</h6></p>
        <div class="cleaner h30"></div>

            <div class="col_w310 float_l">

                <h4>Личные данные</h4>
                <div id="contact_form">

                <form id="formNS" accept-charset="UTF-8" th:method="POST" th:action="@{/myPage}" th:object="${person}">

                    <label for="name">Имя:</label> <input type="text" id="name" class="required input_field"  th:field="*{name}" maxlength="50"/>
                    <div style="color:orange; font-size:12px" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Name error</div>
                    <div class="cleaner h10"></div>

                    <label for="surname">Фамилия:</label> <input type="text" id="surname"  class="required input_field" th:field="*{surname}" maxlength="50"/>
                    <div style="color:orange; font-size:12px" th:if="${#fields.hasErrors('surname')}" th:errors="*{surname}">Surname error</div>
                    <div class="cleaner h10"></div>

                    <label for="birthdate">Дата рождения:</label> <input type="text" id="birthdate" class="required input_field" th:field="*{birthdate}" placeholder="дд.мм.гггг" />
                    <!-- было <input type="date" min="1920-01-01"   id="birthdate"  class="required input_field" th:field="*{birthdate}" /> -->
                    <div class="cleaner h10"></div>

                    <input type="submit" class="submit_btn"  id="submitNS" value="Сохранить" />

                </form>
                </br></br>

                <form  id="formMessage" th:method="POST" th:action="@{/myPage/mail}" th:object="${person}">

                    <label for="textMessage">Отправьте Егорчику сообщение:</label><div id="right" ><span style="float: right;" id="count" ></span></div>
                    <textarea id="textMessage" rows="0" cols="0" class="required" maxlength="200" th:field="*{message}"></textarea>
                    <div style="color:orange; font-size:12px" th:if="${#fields.hasErrors('message')}" th:errors="*{message}">Message error</div>
                    <div class="cleaner h10"></div>

                    <div id="loader" class="hidden" style="margin: 5px 0px; color: orange; font-size: 13px; font-family: Verdana, Arial, sans-serif;"></div>

                    <input type="submit" class="submit_btn"  id="submitMessage" onclick="messageMail()"  value="Отправить" />
                    <input type="reset" class="submit_btn"  id="reset" onclick="reset()" value="Очистить" />

                </form>
                    <script th:inline="javascript">
                        const message = document.getElementById("textMessage");
                        const count = document.getElementById("count");
                        count.innerHTML= "0/"+message.maxLength;
                    message.addEventListener("input",
                        function(event){
                        count.innerHTML= message.value.length+"/"+message.maxLength;

                    });
                    </script>
                </div>
            </div>

            <div class="col_w310 float_r">
              <h4>Фотография</h4>
                <form  id="formPhoto" th:method="GET" th:action="@{/myPage/photo}" th:object="${person}">

                    <div id="dropBox">  </div></br>
                   <input type="hidden" id="hiddenField" th:field="*{photo}" />
                    <button type="submit" class="button" >Выбрать фотографию</button>
   </form>

     </br>
                <form  id="formPhoto2" th:method="POST" th:action="@{/myPage/photo/delete}" th:object="${person}">
     <button type="submit" onclick="deleteImage()" class="button" >Удалить фотографию</button>
                    <input type="hidden" id="hiddenField2" th:field="*{photo}" />
                </form>
     </br></br>

                <div class="cleaner h30"></div>
                </div>

            <div class="cleaner"></div>
          <a href="#" class="gototop"></a>
        </div>
    </div>

</div> <!-- end of warpper -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript">
          $(function(){
//var timeNow=new Date().getTime();
//var  timeZoneOffset=(new Date().getTimezoneOffset()) * 60000;

//var maxDate = new Date(timeNow-timeZoneOffset).toISOString().split('T')[0];
var maxDate = new Date().toISOString().split('T')[0];
console.log(maxDate);

          $('#birthdate').attr('max', maxDate);
          console.log("ok");
          });

</script>
<!-- Скрипты для даты 3шт внизу-->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
<script>
    flatpickr("#birthdate", {
        dateFormat: "Y-m-d",
        altInput: true,
        altFormat: "d.m.Y",
        locale: "ru",
        minDate: "1920-01-01"
    });
</script>

<script src="/js/photo.js"></script>
<script src="/js/deleteImage.js"></script>
<script src="/js/reset.js"></script>
<script src="/js/messageMail.js"></script>
</body>
</html>
